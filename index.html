<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>So-Cal Game Stores ‚Äì Demo (Platform Groups)</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />

  <style>
    /* ============= RESET ============= */
    *, *::before, *::after {
      box-sizing: border-box;
    }
    body {
      margin: 0;
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
      background: #05060a;
      color: #f5f5f5;
    }
    a { color: inherit; text-decoration: none; }

    /* ============= LAYOUT ============= */
    .page {
      min-height: 100vh;
      display: flex;
      flex-direction: column;
    }

    header {
      padding: 16px 20px;
      background: linear-gradient(135deg, #171923, #111827);
      border-bottom: 1px solid rgba(255,255,255,0.08);
      position: sticky;
      top: 0;
      z-index: 10;
    }

    .brand {
      display: flex;
      justify-content: space-between;
      align-items: center;
      gap: 8px;
      margin-bottom: 12px;
    }

    .brand-title {
      font-size: 1.3rem;
      font-weight: 700;
      letter-spacing: 0.04em;
      text-transform: uppercase;
    }

    .brand-pill {
      font-size: 0.75rem;
      padding: 4px 10px;
      border-radius: 999px;
      background: rgba(59,130,246,0.15);
      border: 1px solid rgba(59,130,246,0.7);
      text-transform: uppercase;
      letter-spacing: 0.08em;
      white-space: nowrap;
    }

    .header-sub {
      font-size: 0.85rem;
      color: #a1a1aa;
    }

    main {
      flex: 1;
      padding: 16px 16px 40px;
      max-width: 1080px;
      width: 100%;
      margin: 0 auto;
    }

    /* ============= SEARCH BAR ============= */
    .search-card {
      background: #0b0c10;
      border-radius: 16px;
      padding: 14px 14px 10px;
      border: 1px solid rgba(255,255,255,0.08);
      box-shadow: 0 18px 45px rgba(0,0,0,0.45);
      margin-bottom: 18px;
    }

    .search-row {
      display: flex;
      flex-direction: column;
      gap: 10px;
    }

    .field-group {
      display: flex;
      gap: 8px;
      flex: 1;
    }

    .input-wrapper {
      position: relative;
      flex: 1;
    }

    .input-wrapper input,
    .input-wrapper select {
      width: 100%;
      border-radius: 999px;
      border: 1px solid rgba(255,255,255,0.14);
      background: rgba(15,23,42,0.85);
      color: #f9fafb;
      padding: 10px 14px 10px 32px;
      font-size: 0.9rem;
      outline: none;
      appearance: none;
    }

    .input-wrapper select {
      padding-left: 12px;
    }

    .input-wrapper input::placeholder {
      color: #6b7280;
    }

    .input-icon {
      position: absolute;
      left: 10px;
      top: 50%;
      transform: translateY(-50%);
      font-size: 0.9rem;
      opacity: 0.7;
      pointer-events: none;
    }

    .filter-chips {
      margin-top: 8px;
      display: flex;
      flex-wrap: wrap;
      gap: 6px;
    }

    .chip {
      font-size: 0.7rem;
      padding: 4px 10px;
      border-radius: 999px;
      background: rgba(31,41,55,0.9);
      border: 1px solid rgba(148,163,184,0.5);
      text-transform: uppercase;
      letter-spacing: 0.08em;
      color: #e5e7eb;
    }

    /* ============= RESULTS SUMMARY ============= */
    .results-summary {
      font-size: 0.8rem;
      color: #9ca3af;
      margin-bottom: 10px;
      display: flex;
      justify-content: space-between;
      gap: 8px;
      flex-wrap: wrap;
    }

    .results-summary strong {
      color: #e5e7eb;
      font-weight: 600;
    }

    /* ============= STORE CARDS ============= */
    .store-grid {
      display: flex;
      flex-direction: column;
      gap: 10px;
    }

    .store-card {
      background: #050712;
      border-radius: 16px;
      padding: 12px 12px 10px;
      border: 1px solid rgba(148,163,184,0.25);
    }

    .store-header {
      display: flex;
      justify-content: space-between;
      align-items: baseline;
      gap: 6px;
      margin-bottom: 4px;
    }

    .store-name {
      font-size: 0.98rem;
      font-weight: 600;
    }

    .store-meta {
      font-size: 0.75rem;
      color: #9ca3af;
    }

    .store-address {
      font-size: 0.72rem;
      color: #6b7280;
      margin-top: 2px;
    }

    .store-tags {
      margin-top: 4px;
      display: flex;
      flex-wrap: wrap;
      gap: 4px;
    }

    .store-tag {
      font-size: 0.65rem;
      padding: 2px 8px;
      border-radius: 999px;
      background: rgba(31,41,55,0.9);
      border: 1px solid rgba(75,85,99,0.7);
      text-transform: uppercase;
      letter-spacing: 0.08em;
    }

    /* ============= STORE CONTACT ============= */
    .store-contact {
      margin-top: 6px;
      display: flex;
      flex-wrap: wrap;
      gap: 10px;
      font-size: 0.75rem;
      color: #9ca3af;
      align-items: center;
    }

    .store-contact a {
      color: #e5e7eb;
      text-decoration: none;
      border-bottom: 1px dotted rgba(148,163,184,0.7);
      padding-bottom: 1px;
    }

    .store-contact a:hover {
      border-bottom-style: solid;
    }

    /* ============= GAME LIST ============= */
    .game-list {
      margin-top: 8px;
      border-top: 1px solid rgba(55,65,81,0.8);
      padding-top: 6px;
      display: flex;
      flex-direction: column;
      gap: 6px;
    }

    .game-row {
      display: grid;
      grid-template-columns: minmax(0, 2.2fr) minmax(0, 1fr);
      gap: 4px 8px;
      align-items: center;
      font-size: 0.8rem;
    }

    .game-title {
      font-weight: 500;
      color: #e5e7eb;
    }

    .game-sub {
      font-size: 0.7rem;
      color: #9ca3af;
    }

    .game-price {
      justify-self: end;
      text-align: right;
      font-weight: 600;
      font-size: 0.95rem;
    }

    .game-pill {
      font-size: 0.65rem;
      color: #9ca3af;
    }

    .empty-state {
      margin-top: 30px;
      text-align: center;
      font-size: 0.9rem;
      color: #9ca3af;
    }

    /* ============= TOGGLE MORE LISTINGS ============= */
    .toggle-row {
      margin-top: 6px;
      text-align: right;
    }

    .toggle-btn {
      border: none;
      background: transparent;
      font-size: 0.75rem;
      text-transform: uppercase;
      letter-spacing: 0.08em;
      padding: 4px 0;
      cursor: pointer;
      color: #9ca3af;
    }

    .toggle-btn:hover {
      color: #e5e7eb;
    }

    /* ============= FOOTER ============= */
    footer {
      text-align: center;
      font-size: 0.7rem;
      color: #6b7280;
      padding: 10px 0 16px;
    }

    /* ============= RESPONSIVE ============= */
    @media (min-width: 640px) {
      header {
        padding: 18px 24px;
      }
      main {
        padding: 18px 20px 48px;
      }
      .search-card {
        padding: 18px 16px 12px;
        margin-bottom: 20px;
      }
      .search-row {
        flex-direction: row;
        align-items: center;
        flex-wrap: wrap;
      }
      .filter-chips {
        margin-top: 0;
        justify-content: flex-end;
      }
    }

    @media (min-width: 900px) {
      .store-grid {
        display: grid;
        grid-template-columns: repeat(2, minmax(0, 1fr));
        gap: 12px;
      }
    }
  </style>
</head>
<body>
  <div class="page">
    <header>
      <div class="brand">
        <div>
          <div class="brand-title">So-Cal Game Finder</div>
          <div class="header-sub">Demo: compare physical game prices across local stores</div>
        </div>
        <div class="brand-pill">Prototype</div>
      </div>
    </header>

    <main>
      <!-- SEARCH CARD -->
      <section class="search-card" aria-label="Search games">
        <div class="search-row">
          <div class="field-group">
            <div class="input-wrapper">
              <span class="input-icon">üîç</span>
              <input
                id="searchInput"
                type="text"
                placeholder="Search for a game (e.g. 'Melee', 'Silent Hill 2')"
                autocomplete="off"
              />
            </div>
          </div>

          <div class="field-group">
            <div class="input-wrapper">
              <select id="platformSelect">
                <option value="">All platforms</option>

                <optgroup label="Atari">
                  <option value="Atari 2600">Atari 2600</option>
                  <option value="Atari 5200">Atari 5200</option>
                  <option value="Atari 7800">Atari 7800</option>
                  <option value="Atari Jaguar">Atari Jaguar</option>
                  <option value="Atari Lynx">Atari Lynx</option>
                </optgroup>

                <optgroup label="Nintendo">
                  <option value="3DS">Nintendo 3DS</option>
                  <option value="DS">Nintendo DS</option>
                  <option value="Game Boy">Game Boy</option>
                  <option value="Game Boy Advance">Game Boy Advance</option>
                  <option value="Game Boy Color">Game Boy Color</option>
                  <option value="GameCube">GameCube</option>
                  <option value="N64">Nintendo 64</option>
                  <option value="NES">NES</option>
                  <option value="SNES">SNES</option>
                  <option value="Switch">Nintendo Switch</option>
                  <option value="Virtual Boy">Virtual Boy</option>
                  <option value="Wii">Wii</option>
                  <option value="Wii U">Wii U</option>
                </optgroup>

                <optgroup label="PlayStation">
                  <option value="PS1">PlayStation</option>
                  <option value="PS2">PlayStation 2</option>
                  <option value="PS3">PlayStation 3</option>
                  <option value="PS4">PlayStation 4</option>
                  <option value="PS5">PlayStation 5</option>
                  <option value="PSP">PSP</option>
                  <option value="PS Vita">PS Vita</option>
                </optgroup>

                <optgroup label="Xbox">
                  <option value="Xbox">Xbox</option>
                  <option value="Xbox 360">Xbox 360</option>
                  <option value="Xbox One">Xbox One</option>
                  <option value="Xbox Series X/S">Xbox Series X/S</option>
                </optgroup>

                <optgroup label="Sega">
                  <option value="Game Gear">Game Gear</option>
                  <option value="Genesis">Genesis</option>
                  <option value="Master System">Master System</option>
                  <option value="Saturn">Sega Saturn</option>
                  <option value="Dreamcast">Dreamcast</option>
                </optgroup>

                <optgroup label="NEC / PC Engine">
                  <option value="PC Engine">PC Engine</option>
                  <option value="TurboGrafx-16">TurboGrafx-16</option>
                  <option value="Turbo Duo">Turbo Duo</option>
                </optgroup>

                <optgroup label="SNK / Neo Geo">
                  <option value="Neo Geo AES">Neo Geo AES</option>
                  <option value="Neo Geo CD">Neo Geo CD</option>
                  <option value="Neo Geo Pocket">Neo Geo Pocket</option>
                  <option value="Neo Geo Pocket Color">Neo Geo Pocket Color</option>
                </optgroup>

                <optgroup label="Other / Classic">
                  <option value="3DO">3DO</option>
                  <option value="ColecoVision">ColecoVision</option>
                  <option value="Intellivision">Intellivision</option>
                </optgroup>
              </select>
            </div>
          </div>

          <div class="field-group">
            <div class="input-wrapper">
              <select id="locationSelect">
                <option value="">Any location (So-Cal)</option>
                <option value="la-koreatown">Near me: LA ‚Äì Koreatown</option>
                <option value="riverside-dt">Near me: Riverside ‚Äì Downtown</option>
                <option value="oc-santa-ana">Near me: OC ‚Äì Santa Ana</option>
              </select>
            </div>
          </div>
        </div>

        <div class="filter-chips">
          <span class="chip">Region: So-Cal</span>
          <span class="chip">Physical copies only</span>
          <span class="chip">Prototype: area filter, not GPS</span>
        </div>
      </section>

      <!-- RESULTS SUMMARY -->
      <div class="results-summary" id="resultsSummary">
        <span>Showing <strong>0</strong> matches</span>
        <span>Demo data only ¬∑ not live inventory</span>
      </div>

      <!-- STORE GRID -->
      <section class="store-grid" id="storeGrid">
        <!-- Populated by JS -->
      </section>

      <div class="empty-state" id="emptyState" style="display:none;">
        No matches found for your search.<br />
        Try a different title or clear the filters.
      </div>
    </main>

    <footer>
      This is a front-end demo. Real inventory, live prices &amp; distance would come from store integrations + maps API.
    </footer>
  </div>

  <script>
    // ======== DEMO DATA ========

    const stores = [
      {
        id: "retro-vault-la",
        name: "Retro Vault LA",
        city: "Los Angeles",
        area: "Koreatown",
        address: "3282 Wilshire Blvd, Los Angeles, CA 90010",
        locationKey: "la-koreatown",
        tags: ["Retro", "Imports", "PS2", "GameCube", "Nintendo"],
        phone: "(213) 555-0199",
        instagram: "retrovaultla"
      },
      {
        id: "inland-games-riv",
        name: "Inland Games",
        city: "Riverside",
        area: "Downtown Riverside",
        address: "4215 Main St, Riverside, CA 92501",
        locationKey: "riverside-dt",
        tags: ["Modern", "Retro", "Trading"],
        phone: "(951) 555-0142",
        instagram: "inlandgames"
      },
      {
        id: "oc-byte-exch",
        name: "OC Byte Exchange",
        city: "Orange County",
        area: "Santa Ana",
        address: "117 W 4th St, Santa Ana, CA 92701",
        locationKey: "oc-santa-ana",
        tags: ["Switch", "PS4", "Collectibles"],
        phone: "(714) 555-0177",
        instagram: "ocbyteexchange"
      }
    ];

    // Each entry = one listing of a game in a store
    const inventory = [
      // ==== RETRO VAULT LA: BIG INVENTORY ====
      { title: "Super Mario Bros. 3", platform: "NES",  condition: "Cart only",              price: 24.99, storeId: "retro-vault-la" },
      { title: "The Legend of Zelda", platform: "NES",  condition: "Cart only",              price: 29.99, storeId: "retro-vault-la" },
      { title: "Castlevania III: Dracula's Curse", platform: "NES", condition: "Cart only", price: 59.99, storeId: "retro-vault-la" },

      { title: "Chrono Trigger",      platform: "SNES", condition: "CIB (Complete in Box)",  price: 199.99, storeId: "retro-vault-la" },
      { title: "Super Metroid",       platform: "SNES", condition: "Cart only",              price: 89.99,  storeId: "retro-vault-la" },
      { title: "EarthBound",          platform: "SNES", condition: "Cart only",              price: 249.99, storeId: "retro-vault-la" },

      { title: "Mario Kart 64",       platform: "N64",  condition: "Cart only",              price: 54.99,  storeId: "retro-vault-la" },
      { title: "The Legend of Zelda: Ocarina of Time", platform: "N64", condition: "CIB",   price: 119.99, storeId: "retro-vault-la" },
      { title: "Super Smash Bros.",   platform: "N64",  condition: "Cart only",              price: 79.99,  storeId: "retro-vault-la" },

      { title: "Super Smash Bros. Melee", platform: "GameCube", condition: "CIB (Player's Choice)", price: 79.99, storeId: "retro-vault-la" },
      { title: "Paper Mario: The Thousand-Year Door", platform: "GameCube", condition: "CIB", price: 149.99, storeId: "retro-vault-la" },
      { title: "Metroid Prime",      platform: "GameCube", condition: "CIB",                 price: 59.99,  storeId: "retro-vault-la" },

      { title: "The Legend of Zelda: Twilight Princess", platform: "Wii", condition: "CIB",  price: 49.99,  storeId: "retro-vault-la" },
      { title: "Super Mario Galaxy", platform: "Wii",  condition: "CIB",                     price: 29.99,  storeId: "retro-vault-la" },

      { title: "Pok√©mon FireRed",    platform: "Game Boy Advance",  condition: "Cart only",              price: 119.99, storeId: "retro-vault-la" },
      { title: "Pok√©mon Emerald",    platform: "Game Boy Advance",  condition: "Cart only",              price: 229.99, storeId: "retro-vault-la" },

      { title: "Pok√©mon HeartGold",  platform: "DS",   condition: "Cart only",              price: 149.99, storeId: "retro-vault-la" },
      { title: "Pok√©mon Black 2",    platform: "DS",   condition: "Cart only",              price: 199.99, storeId: "retro-vault-la" },

      { title: "Pok√©mon X",          platform: "3DS",  condition: "CIB",                    price: 39.99,  storeId: "retro-vault-la" },
      { title: "Fire Emblem Awakening", platform: "3DS", condition: "CIB",                  price: 69.99,  storeId: "retro-vault-la" },

      { title: "Final Fantasy VII",  platform: "PS1",  condition: "Black Label, CIB",       price: 79.99,  storeId: "retro-vault-la" },
      { title: "Metal Gear Solid",   platform: "PS1",  condition: "CIB",                    price: 59.99,  storeId: "retro-vault-la" },

      { title: "Silent Hill 2",      platform: "PS2",  condition: "Very Good",              price: 119.99, storeId: "retro-vault-la" },
      { title: "Metal Gear Solid 3: Snake Eater", platform: "PS2", condition: "CIB",        price: 49.99,  storeId: "retro-vault-la" },
      { title: "Kingdom Hearts II",  platform: "PS2",  condition: "CIB",                    price: 34.99,  storeId: "retro-vault-la" },

      { title: "God of War II",      platform: "PS2",  condition: "CIB",                    price: 24.99,  storeId: "retro-vault-la" },

      { title: "Persona 3 Portable", platform: "PSP",  condition: "CIB",                    price: 89.99,  storeId: "retro-vault-la" },
      { title: "Crisis Core: Final Fantasy VII", platform: "PSP", condition: "CIB",        price: 69.99,  storeId: "retro-vault-la" },

      { title: "The Last of Us",     platform: "PS3",  condition: "CIB",                    price: 19.99,  storeId: "retro-vault-la" },
      { title: "Demon's Souls",      platform: "PS3",  condition: "CIB",                    price: 34.99,  storeId: "retro-vault-la" },

      { title: "Bloodborne",         platform: "PS4",  condition: "CIB (Greatest Hits)",    price: 24.99,  storeId: "retro-vault-la" },
      { title: "Persona 5",          platform: "PS4",  condition: "CIB (Steelbook)",        price: 39.99,  storeId: "retro-vault-la" },

      { title: "The Legend of Zelda: Breath of the Wild", platform: "Switch", condition: "CIB", price: 49.99, storeId: "retro-vault-la" },
      { title: "Super Smash Bros. Ultimate", platform: "Switch", condition: "CIB",          price: 54.99,  storeId: "retro-vault-la" },

      { title: "Halo 2",             platform: "Xbox",      condition: "CIB",               price: 19.99,  storeId: "retro-vault-la" },
      { title: "Halo 3",             platform: "Xbox 360",  condition: "CIB",               price: 14.99,  storeId: "retro-vault-la" },

      // ==== INLAND GAMES: SMALLER MIX ====
      { title: "Super Smash Bros. Melee", platform: "GameCube", condition: "Disc only",      price: 64.99, storeId: "inland-games-riv" },
      { title: "Silent Hill 2",      platform: "PS2",  condition: "Good (Greatest Hits)",    price: 89.99, storeId: "inland-games-riv" },
      { title: "God of War III",     platform: "PS3",  condition: "Very Good",               price: 14.99, storeId: "inland-games-riv" },
      { title: "Call of Duty 4: Modern Warfare", platform: "Xbox 360", condition: "CIB",    price: 12.99, storeId: "inland-games-riv" },

      // ==== OC BYTE EXCHANGE: MODERN / SWITCH / PS4 ====
      { title: "The Last of Us Remastered", platform: "PS4", condition: "Like New",          price: 19.99, storeId: "oc-byte-exch" },
      { title: "Mario Kart 8 Deluxe",      platform: "Switch", condition: "New (Sealed)",   price: 54.99, storeId: "oc-byte-exch" },
      { title: "Animal Crossing: New Horizons", platform: "Switch", condition: "CIB",       price: 49.99, storeId: "oc-byte-exch" },
      { title: "Spider-Man (2018)",        platform: "PS4", condition: "CIB",              price: 24.99, storeId: "oc-byte-exch" }
    ];

    // ======== HELPERS ========

    function groupByStore(listings) {
      const groups = {};
      for (const entry of listings) {
        if (!groups[entry.storeId]) groups[entry.storeId] = [];
        groups[entry.storeId].push(entry);
      }
      return groups;
    }

    function formatPrice(num) {
      return "$" + num.toFixed(2);
    }

    function formatPhoneForTel(phone) {
      // Strip non-digits for the tel: link
      return phone.replace(/[^0-9]/g, "");
    }

    function getStoreById(id) {
      return stores.find(s => s.id === id);
    }

    // ======== RENDER ========

    const storeGrid = document.getElementById("storeGrid");
    const emptyState = document.getElementById("emptyState");
    const resultsSummary = document.getElementById("resultsSummary");
    const searchInput = document.getElementById("searchInput");
    const platformSelect = document.getElementById("platformSelect");
    const locationSelect = document.getElementById("locationSelect");

    function renderResults() {
      const query = searchInput.value.trim().toLowerCase();
      const platformFilter = platformSelect.value;
      const locationFilter = locationSelect.value;

      let filtered = inventory.filter(item => {
        let matchesTitle = true;
        let matchesPlatform = true;
        let matchesLocation = true;

        if (query) {
          matchesTitle = item.title.toLowerCase().includes(query);
        }
        if (platformFilter) {
          matchesPlatform = item.platform === platformFilter;
        }
        if (locationFilter) {
          const store = getStoreById(item.storeId);
          if (!store) return false;
          matchesLocation = store.locationKey === locationFilter;
        }

        return matchesTitle && matchesPlatform && matchesLocation;
      });

      const totalMatches = filtered.length;
      const grouped = groupByStore(filtered);

      // Update summary
      resultsSummary.innerHTML =
        `<span>Showing <strong>${totalMatches}</strong> listing${totalMatches === 1 ? "" : "s"}</span>` +
        `<span>${Object.keys(grouped).length} store${Object.keys(grouped).length === 1 ? "" : "s"} after filters</span>`;

      // Clear previous
      storeGrid.innerHTML = "";

      if (filtered.length === 0) {
        emptyState.style.display = "block";
        return;
      } else {
        emptyState.style.display = "none";
      }

      // Render store-by-store
      Object.keys(grouped).forEach(storeId => {
        const store = getStoreById(storeId);
        const listings = grouped[storeId];

        if (!store) return;

        const card = document.createElement("article");
        card.className = "store-card";

        // Header
        const header = document.createElement("div");
        header.className = "store-header";

        const left = document.createElement("div");
        const storeName = document.createElement("div");
        storeName.className = "store-name";
        storeName.textContent = store.name;

        const meta = document.createElement("div");
        meta.className = "store-meta";
        meta.textContent = `${store.city} ¬∑ ${store.area}`;

        const address = document.createElement("div");
        address.className = "store-address";
        address.textContent = store.address;

        left.appendChild(storeName);
        left.appendChild(meta);
        left.appendChild(address);

        const right = document.createElement("div");
        right.className = "store-meta";
        right.textContent = `${listings.length} listing${listings.length === 1 ? "" : "s"}`;

        header.appendChild(left);
        header.appendChild(right);

        // Tags
        const tagsRow = document.createElement("div");
        tagsRow.className = "store-tags";
        store.tags.forEach(tag => {
          const t = document.createElement("span");
          t.className = "store-tag";
          t.textContent = tag;
          tagsRow.appendChild(t);
        });

        // Contact row
        let hasContact = store.phone || store.instagram;
        let contactRow = null;
        if (hasContact) {
          contactRow = document.createElement("div");
          contactRow.className = "store-contact";

          if (store.phone) {
            const phoneLink = document.createElement("a");
            phoneLink.href = `tel:${formatPhoneForTel(store.phone)}`;
            phoneLink.textContent = `üìû ${store.phone}`;
            contactRow.appendChild(phoneLink);
          }

          if (store.instagram) {
            const instaLink = document.createElement("a");
            instaLink.href = `https://instagram.com/${store.instagram}`;
            instaLink.target = "_blank";
            instaLink.rel = "noopener noreferrer";
            instaLink.textContent = `Instagram ¬∑ @${store.instagram}`;
            contactRow.appendChild(instaLink);
          }
        }

        // Game list (with "show more" behavior)
        const gameList = document.createElement("div");
        gameList.className = "game-list";

        // Sort listings by price (cheapest first)
        const sortedListings = listings.slice().sort((a, b) => a.price - b.price);

        const MAX_VISIBLE = 3;
        const visibleListings = sortedListings.slice(0, MAX_VISIBLE);
        const extraListings = sortedListings.slice(MAX_VISIBLE);

        // helper to create a single game row
        function createGameRow(item) {
          const row = document.createElement("div");
          row.className = "game-row";

          const leftCol = document.createElement("div");
          const title = document.createElement("div");
          title.className = "game-title";
          title.textContent = item.title;

          const sub = document.createElement("div");
          sub.className = "game-sub";
          sub.innerHTML = `<span class="game-pill">${item.platform}</span> ¬∑ ${item.condition}`;

          leftCol.appendChild(title);
          leftCol.appendChild(sub);

          const rightCol = document.createElement("div");
          rightCol.className = "game-price";
          rightCol.textContent = formatPrice(item.price);

          row.appendChild(leftCol);
          row.appendChild(rightCol);

          return row;
        }

        // Add the always-visible rows
        visibleListings.forEach(item => {
          gameList.appendChild(createGameRow(item));
        });

        // If there are extra listings, add them in a collapsible container
        let extraContainer = null;
        if (extraListings.length > 0) {
          extraContainer = document.createElement("div");
          extraContainer.style.display = "none";

          extraListings.forEach(item => {
            extraContainer.appendChild(createGameRow(item));
          });

          gameList.appendChild(extraContainer);

          // Toggle button
          const toggleRow = document.createElement("div");
          toggleRow.className = "toggle-row";

          const btn = document.createElement("button");
          btn.className = "toggle-btn";
          btn.type = "button";
          btn.textContent = `Show all ${sortedListings.length} listings`;

          let expanded = false;
          btn.addEventListener("click", () => {
            expanded = !expanded;
            extraContainer.style.display = expanded ? "block" : "none";
            btn.textContent = expanded
              ? "Show fewer listings"
              : `Show all ${sortedListings.length} listings`;
          });

          toggleRow.appendChild(btn);
          gameList.appendChild(toggleRow);
        }

        // Build card
        card.appendChild(header);
        card.appendChild(tagsRow);
        if (contactRow) card.appendChild(contactRow);
        card.appendChild(gameList);

        storeGrid.appendChild(card);
      });
    }

    // ======== EVENTS ========

    searchInput.addEventListener("input", renderResults);
    platformSelect.addEventListener("change", renderResults);
    locationSelect.addEventListener("change", renderResults);

    // Initial render
    renderResults();
  </script>
</body>
</html>
